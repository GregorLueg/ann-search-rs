## GPU-accelerated indices benchmarks and parameter gridsearch

Below are benchmarks shown for the GPU-accelerated code. If you wish to run
the example script, please use:

```bash
cargo run --example gridsearch_gpu --features gpu --release
```

To run all of the benchmarks, you can just run:

```bash
bash examples/run_benchmarks.sh --gpu
```

Similar to the other benchmarks, index building, query against 10% slightly
different data based on the trainings data and full kNN generation is being
benchmarked. Index size in memory is also provided.

## Table of Contents

- [Comparison against CPU exhaustive](#comparison-against-cpu-exhaustive)
- [Comparison against CPU IVF (small dataset)](#with-250k-samples-and-64-dimensions)
- [Comparison against CPU IVF (large dataset)](#with-250k-samples-and-64-dimensions)

### Comparison against CPU exhaustive

The GPU acceleration is notable already in the exhaustive index. The IVF-GPU
reaches very fast speeds here, but not much faster actually than the IVF-CPU
version (or exhaustive GPU index). The advantages for the IVF-GPU index become
more apparent in larger data sets (more to that below). Also to note is that
the data is kept on the GPU for easier access and less frequent transfer between
CPU and GPU, hence, the apparent reduced memory footprint. The data lives on
the GPU for this version.

<details>
<summary><b>GPU - Euclidean (Gaussian)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 150k cells, 32D (CPU vs GPU Exhaustive vs IVF-GPU)
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                         3.30     1_481.69     1_484.99       1.0000     0.000000        18.31
Exhaustive (self)                                          3.30    14_767.61    14_770.92       1.0000     0.000000        18.31
--------------------------------------------------------------------------------------------------------------------------------
GPU-Exhaustive (query)                                     3.63       697.95       701.58       1.0000    42.239541        18.31
GPU-Exhaustive (self)                                      3.63     5_908.67     5_912.31       1.0000    41.895961        18.31
--------------------------------------------------------------------------------------------------------------------------------
IVF-GPU-nl273-np13 (query)                               825.75       627.75     1_453.51       0.9889     0.034509         1.15
IVF-GPU-nl273-np16 (query)                               825.75       585.00     1_410.75       0.9967     0.006517         1.15
IVF-GPU-nl273-np23 (query)                               825.75       589.31     1_415.06       1.0000     0.000003         1.15
IVF-GPU-nl273 (self)                                     825.75     4_744.39     5_570.14       1.0000     0.000003         1.15
IVF-GPU-nl387-np19 (query)                             1_167.26       491.49     1_658.75       0.9926     0.031031         1.15
IVF-GPU-nl387-np27 (query)                             1_167.26       631.18     1_798.44       0.9998     0.000650         1.15
IVF-GPU-nl387 (self)                                   1_167.26     3_205.49     4_372.75       0.9998     0.000681         1.15
IVF-GPU-nl547-np23 (query)                             1_624.92       514.25     2_139.16       0.9882     0.041947         1.15
IVF-GPU-nl547-np27 (query)                             1_624.92       488.87     2_113.79       0.9958     0.014728         1.15
IVF-GPU-nl547-np33 (query)                             1_624.92       557.22     2_182.14       0.9997     0.001039         1.15
IVF-GPU-nl547 (self)                                   1_624.92     3_003.59     4_628.50       0.9997     0.001006         1.15
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

---

<details>
<summary><b>GPU - Cosine (Gaussian)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 150k cells, 32D (CPU vs GPU Exhaustive vs IVF-GPU)
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                         4.13     1_491.14     1_495.27       1.0000     0.000000        18.88
Exhaustive (self)                                          4.13    15_712.49    15_716.62       1.0000     0.000000        18.88
--------------------------------------------------------------------------------------------------------------------------------
GPU-Exhaustive (query)                                     5.32       692.78       698.10       1.0000     0.030828        18.88
GPU-Exhaustive (self)                                      5.32     5_951.89     5_957.20       1.0000     0.030637        18.88
--------------------------------------------------------------------------------------------------------------------------------
IVF-GPU-nl273-np13 (query)                               848.72       625.14     1_473.87       0.9893     0.000025         1.15
IVF-GPU-nl273-np16 (query)                               848.72       609.38     1_458.10       0.9968     0.000006         1.15
IVF-GPU-nl273-np23 (query)                               848.72       686.68     1_535.40       0.9999     0.000000         1.15
IVF-GPU-nl273 (self)                                     848.72     4_822.65     5_671.37       1.0000     0.000000         1.15
IVF-GPU-nl387-np19 (query)                             1_208.20       483.92     1_692.12       0.9928     0.000019         1.15
IVF-GPU-nl387-np27 (query)                             1_208.20       637.32     1_845.52       0.9998     0.000000         1.15
IVF-GPU-nl387 (self)                                   1_208.20     3_202.11     4_410.31       0.9998     0.000001         1.15
IVF-GPU-nl547-np23 (query)                             1_655.07       524.24     2_179.31       0.9890     0.000025         1.15
IVF-GPU-nl547-np27 (query)                             1_655.07       488.26     2_143.33       0.9962     0.000008         1.15
IVF-GPU-nl547-np33 (query)                             1_655.07       550.43     2_205.50       0.9997     0.000001         1.15
IVF-GPU-nl547 (self)                                   1_655.07     2_973.36     4_628.43       0.9997     0.000001         1.15
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

---

<details>
<summary><b>GPU - Euclidean (Correlated)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 150k cells, 32D (CPU vs GPU Exhaustive vs IVF-GPU)
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                         3.08     1_488.37     1_491.46       1.0000     0.000000        18.31
Exhaustive (self)                                          3.08    15_761.54    15_764.63       1.0000     0.000000        18.31
--------------------------------------------------------------------------------------------------------------------------------
GPU-Exhaustive (query)                                     3.46       699.26       702.72       1.0000     2.406931        18.31
GPU-Exhaustive (self)                                      3.46     5_909.46     5_912.92       1.0000     2.415342        18.31
--------------------------------------------------------------------------------------------------------------------------------
IVF-GPU-nl273-np13 (query)                               823.55       526.84     1_350.39       0.9998     0.000027         1.15
IVF-GPU-nl273-np16 (query)                               823.55       580.67     1_404.22       1.0000     0.000006         1.15
IVF-GPU-nl273-np23 (query)                               823.55       669.12     1_492.67       1.0000     0.000000         1.15
IVF-GPU-nl273 (self)                                     823.55     3_702.89     4_526.44       1.0000     0.000000         1.15
IVF-GPU-nl387-np19 (query)                             1_158.54       465.13     1_623.67       0.9999     0.000014         1.15
IVF-GPU-nl387-np27 (query)                             1_158.54       618.69     1_777.23       1.0000     0.000000         1.15
IVF-GPU-nl387 (self)                                   1_158.54     2_990.04     4_148.58       1.0000     0.000000         1.15
IVF-GPU-nl547-np23 (query)                             1_612.33       382.38     1_994.71       0.9999     0.000021         1.15
IVF-GPU-nl547-np27 (query)                             1_612.33       455.66     2_068.00       1.0000     0.000010         1.15
IVF-GPU-nl547-np33 (query)                             1_612.33       542.94     2_155.27       1.0000     0.000000         1.15
IVF-GPU-nl547 (self)                                   1_612.33     2_804.82     4_417.15       1.0000     0.000003         1.15
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

---

<details>
<summary><b>GPU - Euclidean (LowRank)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 150k cells, 32D (CPU vs GPU Exhaustive vs IVF-GPU)
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                         3.39     1_522.36     1_525.74       1.0000     0.000000        18.31
Exhaustive (self)                                          3.39    15_820.91    15_824.29       1.0000     0.000000        18.31
--------------------------------------------------------------------------------------------------------------------------------
GPU-Exhaustive (query)                                     3.58       703.03       706.61       1.0000     8.879391        18.31
GPU-Exhaustive (self)                                      3.58     5_921.65     5_925.23       1.0000     8.901199        18.31
--------------------------------------------------------------------------------------------------------------------------------
IVF-GPU-nl273-np13 (query)                               824.72       515.87     1_340.58       1.0000     0.000015         1.15
IVF-GPU-nl273-np16 (query)                               824.72       574.01     1_398.73       1.0000     0.000001         1.15
IVF-GPU-nl273-np23 (query)                               824.72       640.01     1_464.73       1.0000     0.000001         1.15
IVF-GPU-nl273 (self)                                     824.72     3_327.92     4_152.64       1.0000     0.000001         1.15
IVF-GPU-nl387-np19 (query)                             1_154.98       480.45     1_635.43       1.0000     0.000001         1.15
IVF-GPU-nl387-np27 (query)                             1_154.98       624.94     1_779.92       1.0000     0.000001         1.15
IVF-GPU-nl387 (self)                                   1_154.98     2_984.54     4_139.52       1.0000     0.000001         1.15
IVF-GPU-nl547-np23 (query)                             1_615.84       384.58     2_000.42       1.0000     0.000001         1.15
IVF-GPU-nl547-np27 (query)                             1_615.84       459.54     2_075.38       1.0000     0.000001         1.15
IVF-GPU-nl547-np33 (query)                             1_615.84       535.19     2_151.03       1.0000     0.000001         1.15
IVF-GPU-nl547 (self)                                   1_615.84     2_900.04     4_515.88       1.0000     0.000001         1.15
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

---

<details>
<summary><b>GPU - Euclidean (LowRank; 128 dimensions)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 150k cells, 128D (CPU vs GPU Exhaustive vs IVF-GPU)
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                        15.42     6_074.85     6_090.27       1.0000     0.000000        73.24
Exhaustive (self)                                         15.42    62_432.15    62_447.56       1.0000     0.000000        73.24
--------------------------------------------------------------------------------------------------------------------------------
GPU-Exhaustive (query)                                    15.06     1_765.89     1_780.96       1.0000    75.088674        73.24
GPU-Exhaustive (self)                                     15.06    16_419.82    16_434.88       1.0000    75.325201        73.24
--------------------------------------------------------------------------------------------------------------------------------
IVF-GPU-nl273-np13 (query)                             2_965.45       624.28     3_589.72       0.9997     0.002045         1.15
IVF-GPU-nl273-np16 (query)                             2_965.45       676.71     3_642.15       1.0000     0.000193         1.15
IVF-GPU-nl273-np23 (query)                             2_965.45       772.02     3_737.47       1.0000     0.000011         1.15
IVF-GPU-nl273 (self)                                   2_965.45     4_498.86     7_464.31       1.0000     0.000011         1.15
IVF-GPU-nl387-np19 (query)                             4_142.27       597.90     4_740.17       1.0000     0.000122         1.15
IVF-GPU-nl387-np27 (query)                             4_142.27       671.51     4_813.78       1.0000     0.000011         1.15
IVF-GPU-nl387 (self)                                   4_142.27     3_784.32     7_926.59       1.0000     0.000011         1.15
IVF-GPU-nl547-np23 (query)                             5_585.14       446.98     6_032.13       0.9999     0.000626         1.15
IVF-GPU-nl547-np27 (query)                             5_585.14       536.41     6_121.55       1.0000     0.000072         1.15
IVF-GPU-nl547-np33 (query)                             5_585.14       632.78     6_217.92       1.0000     0.000011         1.15
IVF-GPU-nl547 (self)                                   5_585.14     3_587.81     9_172.95       1.0000     0.000011         1.15
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

### Comparison against IVF CPU

In this case, the IVF CPU implementation is being compared against the GPU
version. GPU acceleration shines with larger data sets and larger dimensions,
hence, the number of samples was increased to 250_000 and dimensions to 64 or
128 for these benchmarks.

#### With 250k samples and 64 dimensions

<details>
<summary><b>CPU-IVF (250k samples; 64 dimensions)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 250k cells, 64D
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                        10.76     4_903.49     4_914.26       1.0000     0.000000        61.04
Exhaustive (self)                                         10.76    84_452.27    84_463.03       1.0000     0.000000        61.04
--------------------------------------------------------------------------------------------------------------------------------
IVF-nl353-np17 (query)                                 2_770.83       749.81     3_520.64       0.9864     0.155740        63.03
IVF-nl353-np18 (query)                                 2_770.83       787.23     3_558.06       0.9916     0.094313        63.03
IVF-nl353-np26 (query)                                 2_770.83     1_123.18     3_894.01       1.0000     0.000000        63.03
IVF-nl353 (self)                                       2_770.83    18_863.23    21_634.06       1.0000     0.000000        63.03
IVF-nl500-np22 (query)                                 3_990.32       697.95     4_688.28       0.9848     0.145201        63.07
IVF-nl500-np25 (query)                                 3_990.32       946.03     4_936.35       0.9962     0.036580        63.07
IVF-nl500-np31 (query)                                 3_990.32     1_234.31     5_224.64       1.0000     0.000000        63.07
IVF-nl500 (self)                                       3_990.32    17_643.14    21_633.46       1.0000     0.000000        63.07
IVF-nl707-np26 (query)                                 5_742.80       593.49     6_336.30       0.9588     0.409737        63.12
IVF-nl707-np35 (query)                                 5_742.80       792.27     6_535.07       0.9956     0.040787        63.12
IVF-nl707-np37 (query)                                 5_742.80       831.81     6_574.62       0.9981     0.017126        63.12
IVF-nl707 (self)                                       5_742.80    13_967.78    19_710.58       0.9983     0.016073        63.12
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

<details>
<summary><b>GPU-IVF (250k samples; 64 dimensions)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 250k cells, 64D (CPU vs GPU Exhaustive vs IVF-GPU)
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                        11.74     4_940.92     4_952.67       1.0000     0.000000        61.04
Exhaustive (self)                                         11.74    84_810.87    84_822.61       1.0000     0.000000        61.04
--------------------------------------------------------------------------------------------------------------------------------
GPU-Exhaustive (query)                                    11.81     1_455.83     1_467.64       1.0000   176.188002        61.04
GPU-Exhaustive (self)                                     11.81    22_166.30    22_178.12       1.0000   176.720169        61.04
--------------------------------------------------------------------------------------------------------------------------------
IVF-GPU-nl353-np17 (query)                             2_850.22       801.03     3_651.25       0.9864     0.155757         1.91
IVF-GPU-nl353-np18 (query)                             2_850.22       798.34     3_648.56       0.9916     0.094331         1.91
IVF-GPU-nl353-np26 (query)                             2_850.22       889.08     3_739.30       1.0000     0.000019         1.91
IVF-GPU-nl353 (self)                                   2_850.22     8_663.83    11_514.05       1.0000     0.000019         1.91
IVF-GPU-nl500-np22 (query)                             4_075.03       678.71     4_753.74       0.9848     0.145574         1.91
IVF-GPU-nl500-np25 (query)                             4_075.03       719.06     4_794.09       0.9962     0.037150         1.91
IVF-GPU-nl500-np31 (query)                             4_075.03       846.66     4_921.69       1.0000     0.000019         1.91
IVF-GPU-nl500 (self)                                   4_075.03     7_544.45    11_619.48       1.0000     0.000019         1.91
IVF-GPU-nl707-np26 (query)                             5_804.67       671.46     6_476.13       0.9588     0.412336         1.91
IVF-GPU-nl707-np35 (query)                             5_804.67       754.06     6_558.72       0.9956     0.040426         1.91
IVF-GPU-nl707-np37 (query)                             5_804.67       794.78     6_599.45       0.9981     0.017444         1.91
IVF-GPU-nl707 (self)                                   5_804.67     6_835.79    12_640.46       0.9983     0.016073         1.91
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

The results here are more favourable of the GPU acceleration. We go from ~85
seconds with exhaustive search on CPU to ~22 seconds on GPU for full kNN
generation; with the IVF variants, we can go from 22 seconds for the CPU based
version to ~11 seconds on the GPU one. The effects become even more pronounced
with higher dimensionality.

<details>
<summary><b>CPU-IVF (250k samples; 128 dimensions)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 250k cells, 128D
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                        24.97    10_944.29    10_969.27       1.0000     0.000000       122.07
Exhaustive (self)                                         24.97   187_209.37   187_234.34       1.0000     0.000000       122.07
--------------------------------------------------------------------------------------------------------------------------------
IVF-nl353-np17 (query)                                 6_242.76     2_090.01     8_332.76       0.9602     0.626147       124.15
IVF-nl353-np18 (query)                                 6_242.76     2_223.65     8_466.41       0.9710     0.465864       124.15
IVF-nl353-np26 (query)                                 6_242.76     3_117.96     9_360.71       1.0000     0.000114       124.15
IVF-nl353 (self)                                       6_242.76    51_905.33    58_148.09       1.0000     0.000064       124.15
IVF-nl500-np22 (query)                                 8_503.01     1_935.51    10_438.52       0.9543     0.683306       124.23
IVF-nl500-np25 (query)                                 8_503.01     2_175.88    10_678.89       0.9746     0.349559       124.23
IVF-nl500-np31 (query)                                 8_503.01     2_631.76    11_134.77       0.9960     0.042523       124.23
IVF-nl500 (self)                                       8_503.01    43_880.16    52_383.17       0.9959     0.046647       124.23
IVF-nl707-np26 (query)                                12_075.68     1_628.88    13_704.56       0.9210     1.089548       124.33
IVF-nl707-np35 (query)                                12_075.68     2_159.59    14_235.26       0.9778     0.270690       124.33
IVF-nl707-np37 (query)                                12_075.68     2_258.72    14_334.40       0.9850     0.179843       124.33
IVF-nl707 (self)                                      12_075.68    37_753.86    49_829.53       0.9854     0.173658       124.33
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

<details>
<summary><b>GPU-IVF (250k samples; 128 dimensions)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 250k cells, 128D (CPU vs GPU Exhaustive vs IVF-GPU)
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                        27.25    11_067.67    11_094.92       1.0000     0.000000       122.07
Exhaustive (self)                                         27.25   187_933.09   187_960.34       1.0000     0.000000       122.07
--------------------------------------------------------------------------------------------------------------------------------
GPU-Exhaustive (query)                                    24.80     2_844.39     2_869.19       1.0000   334.075678       122.07
GPU-Exhaustive (self)                                     24.80    45_059.64    45_084.44       1.0000   336.677663       122.07
--------------------------------------------------------------------------------------------------------------------------------
IVF-GPU-nl353-np17 (query)                             6_073.76       880.40     6_954.16       0.9601     0.623316         1.91
IVF-GPU-nl353-np18 (query)                             6_073.76       887.57     6_961.32       0.9709     0.462600         1.91
IVF-GPU-nl353-np26 (query)                             6_073.76       983.33     7_057.08       1.0000     0.000164         1.91
IVF-GPU-nl353 (self)                                   6_073.76    10_884.45    16_958.21       1.0000     0.000114         1.91
IVF-GPU-nl500-np22 (query)                             8_592.26       897.74     9_490.01       0.9543     0.683393         1.91
IVF-GPU-nl500-np25 (query)                             8_592.26       902.98     9_495.24       0.9746     0.349742         1.91
IVF-GPU-nl500-np31 (query)                             8_592.26       938.16     9_530.43       0.9960     0.042646         1.91
IVF-GPU-nl500 (self)                                   8_592.26    10_018.02    18_610.28       0.9959     0.046699         1.91
IVF-GPU-nl707-np26 (query)                            12_301.87       825.86    13_127.72       0.9208     1.094140         1.91
IVF-GPU-nl707-np35 (query)                            12_301.87       795.97    13_097.83       0.9780     0.269632         1.91
IVF-GPU-nl707-np37 (query)                            12_301.87       862.28    13_164.15       0.9852     0.177282         1.91
IVF-GPU-nl707 (self)                                  12_301.87     8_841.17    21_143.04       0.9854     0.174431         1.91
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

The exhaustive kNN search on the CPU takes ~190 seconds (3 minutes). Leveraging
the GPU, we cut this down to 45 seconds, a 4x speedup. The IVF CPU version
takes in the best case 50 seconds, which gets cut down to 9 seconds. The
GPU acceleration really shines with larger, high dimensionsal data sets.

#### Increasing the number of samples

Results are becoming even more pronounced with more cells and showing the
advantage of the GPU acceleration.

<details>
<summary><b>CPU-IVF (500k samples, 64 dimensions)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 500k cells, 64D
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                        21.17    12_363.28    12_384.45       1.0000     0.000000       122.07
Exhaustive (self)                                         21.17   374_508.72   374_529.89       1.0000     0.000000       122.07
--------------------------------------------------------------------------------------------------------------------------------
IVF-nl500-np22 (query)                                 8_159.70     2_034.87    10_194.58       0.9863     0.123294       126.01
IVF-nl500-np25 (query)                                 8_159.70     2_256.24    10_415.94       0.9955     0.040060       126.01
IVF-nl500-np31 (query)                                 8_159.70     2_863.73    11_023.43       0.9997     0.003572       126.01
IVF-nl500 (self)                                       8_159.70    92_375.36   100_535.06       0.9996     0.003517       126.01
IVF-nl707-np26 (query)                                13_090.90     1_703.49    14_794.39       0.9661     0.282091       126.06
IVF-nl707-np35 (query)                                13_090.90     2_274.66    15_365.56       0.9960     0.020253       126.06
IVF-nl707-np37 (query)                                13_090.90     2_403.42    15_494.32       0.9982     0.006950       126.06
IVF-nl707 (self)                                      13_090.90    79_702.72    92_793.62       0.9981     0.007456       126.06
IVF-nl1000-np31 (query)                               18_064.53     1_417.15    19_481.69       0.9386     0.550127       126.14
IVF-nl1000-np44 (query)                               18_064.53     1_987.14    20_051.67       0.9897     0.071493       126.14
IVF-nl1000-np50 (query)                               18_064.53     2_251.35    20_315.88       0.9968     0.017910       126.14
IVF-nl1000 (self)                                     18_064.53    66_306.42    84_370.95       0.9896     0.073754       126.14
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

---

<details>
<summary><b>GPU-IVF (500k samples, 64 dimensions)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 500k cells, 64D (CPU vs GPU Exhaustive vs IVF-GPU)
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                        21.18    11_917.73    11_938.91       1.0000     0.000000       122.07
Exhaustive (self)                                         21.18   375_001.81   375_022.99       1.0000     0.000000       122.07
--------------------------------------------------------------------------------------------------------------------------------
GPU-Exhaustive (query)                                    20.46     2_773.25     2_793.71       1.0000   176.771542       122.07
GPU-Exhaustive (self)                                     20.46    87_887.56    87_908.02       1.0000   175.738638       122.07
--------------------------------------------------------------------------------------------------------------------------------
IVF-GPU-nl500-np22 (query)                             8_722.14     1_069.89     9_792.03       0.9862     0.124041         3.82
IVF-GPU-nl500-np25 (query)                             8_722.14       999.68     9_721.82       0.9955     0.040078         3.82
IVF-GPU-nl500-np31 (query)                             8_722.14     1_191.14     9_913.27       0.9997     0.003591         3.82
IVF-GPU-nl500 (self)                                   8_722.14    27_124.33    35_846.46       0.9996     0.003536         3.82
IVF-GPU-nl707-np26 (query)                            12_240.39       936.44    13_176.82       0.9662     0.283165         3.82
IVF-GPU-nl707-np35 (query)                            12_240.39     1_029.37    13_269.76       0.9960     0.020274         3.82
IVF-GPU-nl707-np37 (query)                            12_240.39     1_008.52    13_248.90       0.9982     0.007295         3.82
IVF-GPU-nl707 (self)                                  12_240.39    23_695.19    35_935.58       0.9981     0.007693         3.82
IVF-GPU-nl1000-np31 (query)                           17_193.40       983.95    18_177.35       0.9386     0.549576         3.82
IVF-GPU-nl1000-np44 (query)                           17_193.40       990.48    18_183.88       0.9896     0.071779         3.82
IVF-GPU-nl1000-np50 (query)                           17_193.40     1_118.20    18_311.60       0.9968     0.018056         3.82
IVF-GPU-nl1000 (self)                                 17_193.40    20_971.66    38_165.06       0.9896     0.073762         3.82
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

---

<details>
<summary><b>CPU-IVF (500k samples, 128 dimensions)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 500k cells, 128D
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                        49.37    25_577.48    25_626.85       1.0000     0.000000       244.14
Exhaustive (self)                                         49.37   858_420.41   858_469.78       1.0000     0.000000       244.14
--------------------------------------------------------------------------------------------------------------------------------
IVF-nl500-np22 (query)                                16_787.37     4_336.85    21_124.22       0.9457     0.779049       248.20
IVF-nl500-np25 (query)                                16_787.37     4_856.28    21_643.65       0.9650     0.513915       248.20
IVF-nl500-np31 (query)                                16_787.37     5_974.48    22_761.85       0.9896     0.167580       248.20
IVF-nl500 (self)                                      16_787.37   198_258.34   215_045.71       0.9891     0.176109       248.20
IVF-nl707-np26 (query)                                24_908.62     3_676.14    28_584.77       0.9214     1.122417       248.31
IVF-nl707-np35 (query)                                24_908.62     5_010.27    29_918.90       0.9719     0.385717       248.31
IVF-nl707-np37 (query)                                24_908.62     5_113.66    30_022.28       0.9787     0.296936       248.31
IVF-nl707 (self)                                      24_908.62   169_598.74   194_507.36       0.9786     0.312457       248.31
IVF-nl1000-np31 (query)                               35_310.59     3_154.64    38_465.23       0.8873     1.637849       248.45
IVF-nl1000-np44 (query)                               35_310.59     4_412.39    39_722.99       0.9610     0.558133       248.45
IVF-nl1000-np50 (query)                               35_310.59     4_943.04    40_253.63       0.9771     0.340439       248.45
IVF-nl1000 (self)                                     35_310.59   147_971.28   183_281.87       0.9604     0.570177       248.45
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

---

<details>
<summary><b>CPU-IVF (500k samples, 128 dimensions)</b>:</summary>
<pre><code>
================================================================================================================================
Benchmark: 500k cells, 128D (CPU vs GPU Exhaustive vs IVF-GPU)
================================================================================================================================
Method                                               Build (ms)   Query (ms)   Total (ms)     Recall@k   Dist Error    Size (MB)
--------------------------------------------------------------------------------------------------------------------------------
Exhaustive (query)                                        48.00    25_923.57    25_971.57       1.0000     0.000000       244.14
Exhaustive (self)                                         48.00   894_018.68   894_066.69       1.0000     0.000000       244.14
--------------------------------------------------------------------------------------------------------------------------------
GPU-Exhaustive (query)                                    47.33     5_545.63     5_592.96       1.0000   338.736587       244.14
GPU-Exhaustive (self)                                     47.33   178_607.42   178_654.75       1.0000   339.325089       244.14
--------------------------------------------------------------------------------------------------------------------------------
IVF-GPU-nl500-np22 (query)                            19_193.32     1_417.76    20_611.09       0.9458     0.775615         3.82
IVF-GPU-nl500-np25 (query)                            19_193.32     1_253.57    20_446.89       0.9651     0.512121         3.82
IVF-GPU-nl500-np31 (query)                            19_193.32     1_504.08    20_697.40       0.9895     0.168255         3.82
IVF-GPU-nl500 (self)                                  19_193.32    34_104.25    53_297.57       0.9891     0.176438         3.82
IVF-GPU-nl707-np26 (query)                            24_714.67     1_121.65    25_836.32       0.9217     1.114050         3.82
IVF-GPU-nl707-np35 (query)                            24_714.67     1_196.66    25_911.33       0.9716     0.390233         3.82
IVF-GPU-nl707-np37 (query)                            24_714.67     1_225.72    25_940.40       0.9787     0.298502         3.82
IVF-GPU-nl707 (self)                                  24_714.67    29_123.62    53_838.29       0.9786     0.312031         3.82
IVF-GPU-nl1000-np31 (query)                           34_555.08     1_001.72    35_556.80       0.8873     1.638533         3.82
IVF-GPU-nl1000-np44 (query)                           34_555.08     1_216.25    35_771.33       0.9611     0.557559         3.82
IVF-GPU-nl1000-np50 (query)                           34_555.08     1_227.02    35_782.11       0.9772     0.339867         3.82
IVF-GPU-nl1000 (self)                                 34_555.08    27_183.09    61_738.17       0.9604     0.570148         3.82
--------------------------------------------------------------------------------------------------------------------------------
</code></pre>
</details>

In these configurations, we can really appreciate the GPU acceleration. For
64 dimensions, we go in the case of exhaustive</br>
Exhaustive CPU: 380 seconds -> Exhaustive GPU: 90 seconds **(4x)** </br>
IVF CPU: 90 seconds -> IVF GPU: 35 seconds **(2.5x)** </br>
The acceleration is even more significant with higher dimensions, as seen
here for the 128 dimension case.
Exhaustive CPU: 900 seconds -> Exhaustive GPU: 180 seconds **(5x)** </br>
IVF CPU: 180 seconds -> IVF GPU: 55 seconds **(3x)** </br>

*All benchmarks were run on M1 Max MacBook Pro with 64 GB unified memory.*
*The GPU backend was the wgpu backend.*
